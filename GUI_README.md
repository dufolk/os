# 智能 Shell 助手 - GUI 使用说明

## 功能特性

GUI 版本提供了更加直观友好的图形界面，包含以下功能：

- ✅ **可视化操作**: 通过图形界面输入自然语言和查看结果
- ✅ **实时反馈**: 命令分析和执行过程的实时状态显示
- ✅ **历史记录**: 可视化的历史记录列表，支持点击查看详情
- ✅ **统计信息**: 命令执行统计和成功率分析
- ✅ **安全确认**: 执行前弹窗确认，防止误操作
- ✅ **多线程处理**: 后台执行命令，界面不卡顿

## 快速开始

### 1. 安装依赖

```bash
pip install -r requirements.txt
```

主要依赖：
- PyQt6 >= 6.4.0（GUI 框架）
- 其他项目依赖（见 requirements.txt）

### 2. 配置 API Key

设置环境变量（根据你使用的大模型）:

**Windows (PowerShell):**
```powershell
$env:OPENAI_API_KEY="your-api-key-here"
```

**Windows (CMD):**
```cmd
set OPENAI_API_KEY=your-api-key-here
```

### 3. 启动 GUI

**方式一：使用启动脚本（推荐）**
```bash
python run_gui.py
```

**方式二：直接运行**
```bash
python src/gui_main.py
```

## 界面说明

### 主界面

主界面分为三个主要区域：

#### 1. 左侧 - 操作区域

- **自然语言输入框**: 输入你的需求描述
- **分析命令按钮**: 将自然语言转换为 Shell 命令
- **执行命令按钮**: 执行生成的命令（需要确认）
- **清空按钮**: 清空所有输入和输出
- **生成的命令**: 显示 LLM 生成的命令和解释
- **执行结果**: 显示命令执行的输出

#### 2. 右侧 - 历史记录

- **历史记录列表**: 显示最近 20 条执行记录
- **刷新按钮**: 刷新历史记录列表
- **清空历史按钮**: 清空所有历史记录
- 点击历史记录项可以查看详细信息

#### 3. 统计信息标签页

- 总命令数
- 成功/失败次数
- 成功率
- 最常用的命令

## 使用流程

### 基本使用

1. **输入自然语言描述**
   - 在输入框中输入你的需求
   - 例如："显示当前目录的所有文件"

2. **分析命令**
   - 点击"🔍 分析命令"按钮
   - 等待 LLM 分析（状态栏会显示"正在分析..."）
   - 生成的命令会显示在"生成的命令"区域

3. **执行命令**
   - 检查生成的命令是否正确
   - 点击"▶️ 执行命令"按钮
   - 在弹出的确认对话框中点击"Yes"
   - 执行结果会显示在"执行结果"区域

4. **查看历史**
   - 右侧历史记录列表会自动更新
   - 点击任意历史记录查看详情
   - 可以在"统计信息"标签页查看统计数据

### 示例场景

#### 场景 1: 文件操作
```
输入: 查找当前目录下所有的 Python 文件
生成命令: dir *.py /s (Windows) 或 find . -name "*.py" (Linux)
```

#### 场景 2: 系统监控
```
输入: 查看系统内存使用情况
生成命令: systeminfo | findstr Memory (Windows) 或 free -h (Linux)
```

#### 场景 3: 进程管理
```
输入: 显示所有正在运行的进程
生成命令: tasklist (Windows) 或 ps aux (Linux)
```

## 界面特性

### 1. 现代化设计
- 清爽的白色主题
- 圆角边框和阴影效果
- 绿色主题色，符合终端风格

### 2. 用户友好
- 大字体，易于阅读
- 清晰的状态提示
- 图标按钮，直观易懂

### 3. 安全保护
- 执行前必须确认
- 危险命令警告
- 错误信息清晰显示

### 4. 性能优化
- 多线程处理，界面不卡顿
- 后台执行命令
- 异步 LLM 调用

## 快捷键

- **Enter**: 在输入框中按 Enter 直接分析命令
- **Alt+F4**: 关闭窗口

## 演示建议

### 演示准备

1. **准备测试场景**
   - 文件操作（查找、列出、复制）
   - 系统信息（CPU、内存、磁盘）
   - 网络操作（ping、查看连接）

2. **设置好 API Key**
   - 确保 LLM 接口可以正常调用
   - 测试几个简单命令确认功能正常

3. **清空历史记录**
   - 演示前清空历史，从干净状态开始
   - 或者保留一些典型的历史记录作为展示

### 演示流程

1. **启动展示**
   - 运行 `python run_gui.py`
   - 介绍界面布局和功能区域

2. **基础功能演示**
   - 输入简单命令："显示当前目录"
   - 展示分析过程
   - 展示执行过程和结果

3. **高级功能演示**
   - 展示历史记录功能
   - 展示统计信息
   - 展示错误处理（输入一个会失败的命令）

4. **安全特性演示**
   - 输入一个危险命令（如删除文件）
   - 展示警告提示
   - 展示确认对话框

5. **总结**
   - 回顾主要功能
   - 展示统计信息
   - 说明项目意义

## 故障排除

### 问题 1: PyQt6 导入错误
```
ImportError: No module named 'PyQt6'
```
**解决方案**: 安装 PyQt6
```bash
pip install PyQt6
```

### 问题 2: LLM 调用失败
```
LLM 调用失败: API key not found
```
**解决方案**: 设置环境变量
```bash
# Windows PowerShell
$env:OPENAI_API_KEY="your-key"
```

### 问题 3: 界面显示异常
**解决方案**: 
- 检查屏幕分辨率（建议 1920x1080 或更高）
- 调整窗口大小
- 重启应用程序

### 问题 4: 命令执行超时
**解决方案**: 
- 在 `config.json` 中增加 `command_timeout` 值
- 或者取消当前操作，重新执行

## 技术架构

### 核心组件

1. **SmartShellGUI**: 主窗口类
   - 管理所有 UI 组件
   - 协调各个模块

2. **LLMWorker**: LLM 调用线程
   - 后台调用大模型
   - 避免界面卡顿

3. **CommandWorker**: 命令执行线程
   - 后台执行 Shell 命令
   - 实时返回结果

### 数据流

```
用户输入 → LLMWorker → 生成命令 → 用户确认 → CommandWorker → 执行结果 → 历史记录
```

## 扩展建议

- [ ] 添加命令模板库
- [ ] 支持命令编辑功能
- [ ] 添加深色主题
- [ ] 支持命令收藏功能
- [ ] 添加命令执行进度条
- [ ] 支持批量执行命令
- [ ] 添加命令执行日志导出

## 许可证

MIT License

## 作者

操作系统课程项目 - GUI 版本
